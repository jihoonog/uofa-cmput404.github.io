<!DOCTYPE html>
<html lang="en">
<head>
          <title>CMPUT 404 - Lab 4 - Django</title>
        <meta charset="utf-8" />

  <link rel="icon" href="https://uofa-cmput404.github.io/theme/favicon.ico" />
  <link rel="stylesheet" type="text/css" href="https://uofa-cmput404.github.io/theme/style.css" />




    <meta name="tags" content="django" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://uofa-cmput404.github.io/">CMPUT 404 <strong></strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="https://uofa-cmput404.github.io/">Home</a></li>
            <li class="active"><a href="https://uofa-cmput404.github.io/category/lab.html">Lab</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://uofa-cmput404.github.io/lab-4-django.html" rel="bookmark"
         title="Permalink to Lab 4 - Django">Lab 4 - Django</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2019-01-07T09:10:00-07:00">
      Mon, 07 Jan 2019 at 09:10 MST
    </time>
    <time class="modified" datetime="2021-10-12T10:00:00-06:00">
      Tue, 12 Oct 2021 at 10:00 MDT
    </time>
    <address class="vcard author">
      By           <a class="url fn" href="https://uofa-cmput404.github.io/author/alexander-wong.html">Alexander Wong</a>
          <a class="url fn" href="https://uofa-cmput404.github.io/author/xin-yang.html">Xin Yang</a>
    </address>
    <div class="category">
        Category: <a href="https://uofa-cmput404.github.io/category/lab.html">Lab</a>
    </div>
    <div class="tags">
        Tags:
            <a href="https://uofa-cmput404.github.io/tag/django.html">django</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <hr>
<p>Big lab! Build a simple <a href="https://www.djangoproject.com/">Django</a> website. Understand the fundamentals of Django's MVC architecture using the built in models and views. </p>
<p>Answers to the questions should be submitted to <em>Lab 4</em> on eClass. You may also follow along with the <a href="https://docs.djangoproject.com/en/3.1/#first-steps">official documentation</a>. We will be going through Parts 1 to 4 of the first steps tutorial in lab. You should commit your project to git after each question.</p>
<h3>Creating a Django Project</h3>
<ul>
<li>Official Docs <a href="https://docs.djangoproject.com/en/3.1/intro/overview/">Overview</a>, <a href="https://docs.djangoproject.com/en/3.1/intro/install/">Installation</a></li>
</ul>
<p>Create a virtual environment and install Django.</p>
<p>Make sure to use a <strong>virtual environment</strong> for this lab!</p>
<p>If you're doing this on <strong>Windows</strong> please make sure to follow the Windows
instructions for Lab 1 before starting this lab!</p>
<div class="highlight"><pre><span></span>virtualenv venv --python<span class="o">=</span>python3
<span class="nb">source</span> venv/bin/activate
pip install <span class="nv">Django</span><span class="o">==</span><span class="m">3</span>.1.6 <span class="c1"># latest official version</span>
</pre></div>


<p>Initialize a new Django project called <strong>mysite</strong>.</p>
<div class="highlight"><pre><span></span>django-admin startproject mysite
<span class="nb">cd</span> mysite
python manage.py runserver
</pre></div>


<p>Add your files and push the contents to GitHub. The <em>manage.py</em> file should be at the root of your github repository.</p>
<p><strong>Question 1</strong>: What is the link to your github repository for this lab?</p>
<p><strong>Question 2</strong>: After starting a brand new Django application and running the runserver command, what does the browser show you?</p>
<hr>
<h3>Creating a Django App</h3>
<ul>
<li>Official Docs <a href="https://docs.djangoproject.com/en/3.1/intro/tutorial01/">Part 1</a></li>
</ul>
<p>Create a new application within <strong>mysite</strong> called <strong>polls</strong>.</p>
<div class="highlight"><pre><span></span>python manage.py startapp polls
</pre></div>


<p>Modify the <em>polls/views.py</em> file to look like the following.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;Hello, world. You&#39;re at the polls index.&quot;</span><span class="p">)</span>
</pre></div>


<p>Create a file at <em>polls/urls.py</em> with the following code.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
  <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p>Within <em>mysite/urls.py</em> include the following code.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">path</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;polls/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s1">&#39;polls.urls&#39;</span><span class="p">)),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;admin/&#39;</span><span class="p">,</span> <span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p>Run the Django project with the runserver command.</p>
<div class="highlight"><pre><span></span>python manage.py runserver
</pre></div>


<p><strong>Question 3</strong>: After creating the first view within polls, what does the browser show you when navigating to <code>/</code> and to <code>/polls</code> respectively?</p>
<hr>
<h3>Working with Models</h3>
<ul>
<li>Official Docs <a href="https://docs.djangoproject.com/en/3.1/intro/tutorial02/">Part 2</a></li>
</ul>
<p>Time to create our first models. Open up <em>mysite/settings.py</em> and ensure that the default database is set to <code>sqlite3</code>.</p>
<div class="highlight"><pre><span></span><span class="c1"># Database</span>
<span class="c1"># https://docs.djangoproject.com/en/2.1/ref/settings/#databases</span>

<span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;django.db.backends.sqlite3&#39;</span><span class="p">,</span>
        <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="s1">&#39;db.sqlite3&#39;</span><span class="p">),</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Within <em>polls/models.py</em> include the following code.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Question</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">question_text</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">pub_date</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">(</span><span class="s1">&#39;date published&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Choice</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">question</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="n">Question</span><span class="p">,</span> <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">CASCADE</span><span class="p">)</span>
    <span class="n">choice_text</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">votes</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">IntegerField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>


<p>To activate our poll application in our project, add it to the installed apps within <em>mysite/settings.py</em>.</p>
<div class="highlight"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;polls.apps.PollsConfig&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.admin&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.auth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.contenttypes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.sessions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.messages&#39;</span><span class="p">,</span>
    <span class="s1">&#39;django.contrib.staticfiles&#39;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>


<p>Make the database migrations.</p>
<div class="highlight"><pre><span></span>python manage.py makemigrations polls
</pre></div>


<p>Run the migration command to create the tables in your database.</p>
<div class="highlight"><pre><span></span>python manage.py migrate
</pre></div>


<p><strong>Question 4</strong>: What is a Django migration and why do we need them?</p>
<hr>
<h3>Using Django Admin</h3>
<p>Create a user that can log into the admin site.</p>
<div class="highlight"><pre><span></span>python manage.py createsuperuser
</pre></div>


<p>Make the polls app modifiable in the admin by editing the <em>polls/admin.py</em> file to be the following:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Choice</span><span class="p">,</span> <span class="n">Question</span>

<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Choice</span><span class="p">)</span>
<span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Question</span><span class="p">)</span>
</pre></div>


<p>Start the development server again and go to <code>/admin</code> on local application.</p>
<div class="highlight"><pre><span></span>python manage.py runserver
</pre></div>


<p><strong>Question 5</strong>: What do you see after you log into the Django adminstration site? From a high levle, how do you get custom models to appear in the Django admin page?</p>
<hr>
<h3>Working with Views</h3>
<ul>
<li>Official Docs <a href="https://docs.djangoproject.com/en/3.1/intro/tutorial03/">Part 3</a></li>
</ul>
<p>Add some additional views to the <em>polls/views.py</em> file. Include the following methods:</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">question_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;You&#39;re looking at question </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">question_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">results</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">question_id</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="s2">&quot;You&#39;re looking at the results of question </span><span class="si">%s</span><span class="s2">.&quot;</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">response</span> <span class="o">%</span> <span class="n">question_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">vote</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">question_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="s2">&quot;You&#39;re voting on question </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="n">question_id</span><span class="p">)</span>
</pre></div>


<p>With the above views added, add them to <em>polls/urls.py</em>.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="c1"># ex: /polls/</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">),</span>
    <span class="c1"># ex: /polls/5/</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&lt;int:question_id&gt;/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">detail</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;detail&#39;</span><span class="p">),</span>
    <span class="c1"># ex: /polls/5/results/</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&lt;int:question_id&gt;/results/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">results</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;results&#39;</span><span class="p">),</span>
    <span class="c1"># ex: /polls/5/vote/</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&lt;int:question_id&gt;/vote/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">vote</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;vote&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p><strong>Question 6</strong>: What do you see when you go to <code>/polls/38/</code> in your browser? What about <code>/polls/38/results</code> and <code>/polls/38/vote</code>? What happens when you don’t put a number, and instead use a string? How would you modify the <em>urls.py</em> file to allow arbitrary alphabetic characters?</p>
<hr>
<h3>Making views render model data</h3>
<p>Update the <em>polls/views.py</em> <code>index</code> method so the questions are returned.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Question</span>


<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">latest_question_list</span> <span class="o">=</span> <span class="n">Question</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-pub_date&#39;</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">q</span><span class="o">.</span><span class="n">question_text</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">latest_question_list</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="c1"># Leave the rest of the views (detail, results, vote) unchanged</span>
</pre></div>


<p>Create an empty directory named <em>templates</em> within <em>polls</em>. Then create another directory named <em>polls</em> within the <em>templates</em> directory. Lastly create a file called <em>index.html</em> within the second <em>polls</em> directory.</p>
<div class="highlight"><pre><span></span>mkdir -p polls/templates/polls
touch polls/templates/polls/index.html
</pre></div>


<p>Within the newly created empty <em>polls/templates/polls/index.html</em> file, write the following.</p>
<div class="highlight"><pre><span></span>{% if latest_question_list %}
    <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
    {% for question in latest_question_list %}
        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/polls/{{ question.id }}/&quot;</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    {% endfor %}
    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
{% else %}
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>No polls are available.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
{% endif %}
</pre></div>


<p>Update the <code>index</code> view in <em>polls/views.py</em> to use the new template.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Question</span>


<span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">latest_question_list</span> <span class="o">=</span> <span class="n">Question</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-pub_date&#39;</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;latest_question_list&#39;</span><span class="p">:</span> <span class="n">latest_question_list</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;polls/index.html&#39;</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
</pre></div>


<p>Add a new template file for the poll details view.</p>
<div class="highlight"><pre><span></span>touch polls/templates/polls/detail.html
</pre></div>


<p>For the newly created template in <em>polls/templates/polls/detail.html</em>, update the content with the template tag for our question:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
{% for choice in question.choice_set.all %}
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>{{ choice.choice_text }}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
{% endfor %}
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
</pre></div>


<p>Update the <code>detail</code> view in <em>polls/views.py</em> to use the new template.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">get_object_or_404</span><span class="p">,</span> <span class="n">render</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Question</span>
<span class="c1"># ...</span>
<span class="k">def</span> <span class="nf">detail</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">question_id</span><span class="p">):</span>
    <span class="n">question</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Question</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">question_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;polls/detail.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;question&#39;</span><span class="p">:</span> <span class="n">question</span><span class="p">})</span>
</pre></div>


<p>Remove the hardcoded urls that we specified in the <em>polls/templates/polls/index.html</em> file and replace it with at emplate tag referencing our url.</p>
<div class="highlight"><pre><span></span><span class="c">&lt;!-- old --&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/polls/{{ question.id }}/&quot;</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>

<span class="c">&lt;!-- new --&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;detail&#39; question.id %}&quot;</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</pre></div>


<hr>
<h3>Namespacing URL names</h3>
<p>Add an <code>app_name</code> in the <em>polls/urls.py</em> file to set the application namespace.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">app_name</span> <span class="o">=</span> <span class="s1">&#39;polls&#39;</span>
<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&lt;int:question_id&gt;/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">detail</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;detail&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&lt;int:question_id&gt;/results/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">results</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;results&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&lt;int:question_id&gt;/vote/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">vote</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;vote&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p>Change your <em>polls/index.html</em> template to point at the namespaced detail view.</p>
<div class="highlight"><pre><span></span><span class="c">&lt;!-- old --&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;detail&#39; question.id %}&quot;</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>

<span class="c">&lt;!-- new --&gt;</span>
<span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;polls:detail&#39; question.id %}&quot;</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
</pre></div>


<p><strong>Question 7</strong>: Why is it a bad idea to hardcode urls into the templates?</p>
<hr>
<h3>Writing a simple form</h3>
<ul>
<li>Official Docs <a href="https://docs.djangoproject.com/en/3.1/intro/tutorial04/">Part 4</a></li>
</ul>
<p>Update the <em>polls/templates/polls/detail.html</em> file to match the following:</p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

{% if error_message %}<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>{{ error_message }}<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>{% endif %}

<span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;{% url &#39;polls:vote&#39; question.id %}&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;post&quot;</span><span class="p">&gt;</span>
{% csrf_token %}
{% for choice in question.choice_set.all %}
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;radio&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;choice&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;choice{{ forloop.counter }}&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ choice.id }}&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">label</span> <span class="na">for</span><span class="o">=</span><span class="s">&quot;choice{{ forloop.counter }}&quot;</span><span class="p">&gt;</span>{{ choice.choice_text }}<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
{% endfor %}
<span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Vote&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</pre></div>


<p>Create a url <em>polls/urls.py</em> that handles the form submitted data.</p>
<div class="highlight"><pre><span></span><span class="n">path</span><span class="p">(</span><span class="s1">&#39;&lt;int:question_id&gt;/vote/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">vote</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;vote&#39;</span><span class="p">),</span>
</pre></div>


<p>Update the <code>vote</code> view in <em>polls/views.py</em> to handle the new template.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span><span class="p">,</span> <span class="n">HttpResponseRedirect</span>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">get_object_or_404</span><span class="p">,</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Choice</span><span class="p">,</span> <span class="n">Question</span>
<span class="c1"># ...</span>
<span class="k">def</span> <span class="nf">vote</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">question_id</span><span class="p">):</span>
    <span class="n">question</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Question</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">question_id</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">selected_choice</span> <span class="o">=</span> <span class="n">question</span><span class="o">.</span><span class="n">choice_set</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">POST</span><span class="p">[</span><span class="s1">&#39;choice&#39;</span><span class="p">])</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="n">Choice</span><span class="o">.</span><span class="n">DoesNotExist</span><span class="p">):</span>
        <span class="c1"># Redisplay the question voting form.</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;polls/detail.html&#39;</span><span class="p">,</span> <span class="p">{</span>
            <span class="s1">&#39;question&#39;</span><span class="p">:</span> <span class="n">question</span><span class="p">,</span>
            <span class="s1">&#39;error_message&#39;</span><span class="p">:</span> <span class="s2">&quot;You didn&#39;t select a choice.&quot;</span><span class="p">,</span>
        <span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">selected_choice</span><span class="o">.</span><span class="n">votes</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">selected_choice</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
        <span class="c1"># Always return an HttpResponseRedirect after successfully dealing</span>
        <span class="c1"># with POST data. This prevents data from being posted twice if a</span>
        <span class="c1"># user hits the Back button.</span>
        <span class="k">return</span> <span class="n">HttpResponseRedirect</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="s1">&#39;polls:results&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">question</span><span class="o">.</span><span class="n">id</span><span class="p">,)))</span>
</pre></div>


<p>After voting, the application should redirect to a view displaying the results. Update the <code>results</code> view in <em>polls/views.py</em></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">get_object_or_404</span><span class="p">,</span> <span class="n">render</span>


<span class="k">def</span> <span class="nf">results</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">question_id</span><span class="p">):</span>
    <span class="n">question</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Question</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">question_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;polls/results.html&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;question&#39;</span><span class="p">:</span> <span class="n">question</span><span class="p">})</span>
</pre></div>


<p>Create a template for the results in <em>polls/templates/polls/results.html</em></p>
<div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>{{ question.question_text }}<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
{% for choice in question.choice_set.all %}
    <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span>{{ choice.choice_text }} -- {{ choice.votes }} vote{{ choice.votes|pluralize }}<span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
{% endfor %}
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{% url &#39;polls:detail&#39; question.id %}&quot;</span><span class="p">&gt;</span>Vote again?<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</pre></div>


<p>Run your application. Use the admin interface to create aquestion, then create multiple choices for your question. Navigate back to <code>polls/</code> and attempt to use your application.</p>
<hr>
<h3>Refactoring: Generic Views</h3>
<p>To convert the <code>poll</code> application to use generic views, we will:</p>
<ol>
<li>Convert the old url conf.</li>
<li>Delete some of the old, unnecessary views.</li>
<li>Introduce new views based on Django's generic views.</li>
</ol>
<p>Amend the <em>polls/urls.py</em> url configuration. Note that the name of the matched pattern in the path strings of the second and third patterns has changed from <code>&lt;question_id&gt;</code> to <code>&lt;pk&gt;</code>.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">path</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span>

<span class="n">app_name</span> <span class="o">=</span> <span class="s1">&#39;polls&#39;</span>
<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">IndexView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&lt;int:pk&gt;/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">DetailView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;detail&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&lt;int:pk&gt;/results/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">ResultsView</span><span class="o">.</span><span class="n">as_view</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;results&#39;</span><span class="p">),</span>
    <span class="n">path</span><span class="p">(</span><span class="s1">&#39;&lt;int:question_id&gt;/vote/&#39;</span><span class="p">,</span> <span class="n">views</span><span class="o">.</span><span class="n">vote</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;vote&#39;</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>


<p>Amend the <em>polls/views.py</em> file.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponseRedirect</span>
<span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">get_object_or_404</span><span class="p">,</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">django.urls</span> <span class="kn">import</span> <span class="n">reverse</span>
<span class="kn">from</span> <span class="nn">django.views</span> <span class="kn">import</span> <span class="n">generic</span>

<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">Choice</span><span class="p">,</span> <span class="n">Question</span>


<span class="k">class</span> <span class="nc">IndexView</span><span class="p">(</span><span class="n">generic</span><span class="o">.</span><span class="n">ListView</span><span class="p">):</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;polls/index.html&#39;</span>
    <span class="n">context_object_name</span> <span class="o">=</span> <span class="s1">&#39;latest_question_list&#39;</span>

    <span class="k">def</span> <span class="nf">get_queryset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the last five published questions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Question</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s1">&#39;-pub_date&#39;</span><span class="p">)[:</span><span class="mi">5</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">DetailView</span><span class="p">(</span><span class="n">generic</span><span class="o">.</span><span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Question</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;polls/detail.html&#39;</span>


<span class="k">class</span> <span class="nc">ResultsView</span><span class="p">(</span><span class="n">generic</span><span class="o">.</span><span class="n">DetailView</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Question</span>
    <span class="n">template_name</span> <span class="o">=</span> <span class="s1">&#39;polls/results.html&#39;</span>


<span class="k">def</span> <span class="nf">vote</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">question_id</span><span class="p">):</span>
    <span class="o">...</span> <span class="c1"># same as above, no changes needed.</span>
</pre></div>


<p><strong>Question 8</strong>: What are the benefits of using Django's generic views over writing views 'the hard way'? When should you use a generic view and when shouldn't you use a generic view?</p>

<hr>

<h3 id="serializing-and-deserializing-queries">Serializing and Deserializing Queries (Optional, but strongly recommended to do)</h3>
<p>Based from the DRF (Django Rest Framework) tutorial <a href="https://www.django-rest-framework.org/tutorial/1-serialization/">here</a></p>
<p>To convert your queries to or from a JSON object you can use Django’s serializers to serialize or deserialize Django QuerySets to or from JSON objects.</p>
<p>First install the Django Rest Framework library using <code>pip</code></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">pip</span> install djangorestframework</a></code></pre></div>
<p>Then add the <code>rest_framework</code> app to <code>INSTALLED_APPS</code> in our <code>mysite/settings.py</code> file</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb2-1" title="1">INSTALLED_APPS <span class="op">=</span> [</a>
<a class="sourceLine" id="cb2-2" title="2">    ...</a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="st">&#39;rest_framework&#39;</span></a>
<a class="sourceLine" id="cb2-4" title="4">]</a></code></pre></div>
<h4 id="creating-a-serializer-class">Creating a Serializer Class</h4>
<p>Create a file in the <code>polls</code> directory named <code>serializers.py</code> and add the following</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb3-1" title="1"><span class="im">from</span> rest_framework <span class="im">import</span> serializers</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="im">from</span> .models <span class="im">import</span> Question</a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">class</span> QuestionSerializer(serializers.Serializer):</a>
<a class="sourceLine" id="cb3-5" title="5">    question_text <span class="op">=</span> serializers.CharField()</a>
<a class="sourceLine" id="cb3-6" title="6">    pub_date <span class="op">=</span> serializers.DateTimeField()</a>
<a class="sourceLine" id="cb3-7" title="7"></a>
<a class="sourceLine" id="cb3-8" title="8">    <span class="kw">def</span> create(<span class="va">self</span>, validated_data):</a>
<a class="sourceLine" id="cb3-9" title="9">        <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">        Create and return a new `Question` instance, given the validated data</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">        &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb3-12" title="12">        <span class="cf">return</span> Question.<span class="bu">object</span>.create(<span class="op">**</span>validated_data)</a>
<a class="sourceLine" id="cb3-13" title="13">    </a>
<a class="sourceLine" id="cb3-14" title="14">    <span class="kw">def</span> update(<span class="va">self</span>, instance, validated_data):</a>
<a class="sourceLine" id="cb3-15" title="15">        <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">        Update and return an existing `Question` instance, given the validated data</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="co">        &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb3-18" title="18">        instance.question_text <span class="op">=</span> validated_data.get(<span class="st">&#39;question_text&#39;</span>, instance.question_text)</a>
<a class="sourceLine" id="cb3-19" title="19">        instance.pub_date <span class="op">=</span> validated_data.get(<span class="st">&#39;pub_date&#39;</span>, instance.pub_date)</a>
<a class="sourceLine" id="cb3-20" title="20">        instance.save()</a>
<a class="sourceLine" id="cb3-21" title="21">        <span class="cf">return</span> instance</a></code></pre></div>
<h4 id="update-our-views-using-our-serializer">Update our views using our Serializer</h4>
<p>Once you have the serializers you now need to write some API views using the new Serializer class</p>
<p>Edit the <code>polls/views.py</code> file, and add the following</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb4-1" title="1"><span class="im">from</span> rest_framework.decorators <span class="im">import</span> api_view</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="im">from</span> rest_framework.response <span class="im">import</span> Response</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="im">from</span> .serializers <span class="im">import</span> QuestionSerializer</a>
<a class="sourceLine" id="cb4-4" title="4"></a>
<a class="sourceLine" id="cb4-5" title="5">...</a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7"></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="at">@api_view</span>([<span class="st">&#39;GET&#39;</span>])</a>
<a class="sourceLine" id="cb4-9" title="9"><span class="kw">def</span> get_questions(request):</a>
<a class="sourceLine" id="cb4-10" title="10">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">    Get the list of questions on our website</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb4-13" title="13">    questions <span class="op">=</span> Question.objects.<span class="bu">all</span>()</a>
<a class="sourceLine" id="cb4-14" title="14">    serializer <span class="op">=</span> QuestionSerializer(questions, many<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb4-15" title="15">    <span class="cf">return</span> Response(serializer.data)</a></code></pre></div>
<p>The <code>@api_view</code> decorator will wrap the view so that only HTTP methods that are listed in the decorator will get executed.</p>
<h4 id="updating-the-our-urls-for-the-new-views">Updating the our URLs for the new views</h4>
<p>Because we want our API responses to have JSON objects we will have to add another set of urls with a <code>api/</code> prefix to our <code>polls/urls.py</code> file.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb5-1" title="1"><span class="im">from</span> django.urls <span class="im">import</span> path</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="im">from</span> . <span class="im">import</span> views</a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4">urlpatterns <span class="op">=</span> [</a>
<a class="sourceLine" id="cb5-5" title="5">    ...</a>
<a class="sourceLine" id="cb5-6" title="6">    path(<span class="st">&#39;api/questions/&#39;</span>, views.get_questions, name<span class="op">=</span><span class="st">&#39;get_questions&#39;</span>),</a>
<a class="sourceLine" id="cb5-7" title="7">]</a></code></pre></div>
<p>Now run the project again with the <code>runserver</code> command and go to <code>polls/api/questions/</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb6-1" title="1"><span class="ex">python</span> manage.py runserver</a></code></pre></div>
<p>You should see a list of question in a json format.</p>
<h4 id="updating-a-question-using-our-serializer">Updating a Question Using our Serializer</h4>
<p>We can use the serializer to update the <code>question_text</code> field of our question entries.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb7-1" title="1"><span class="at">@api_view</span>([<span class="st">&#39;POST&#39;</span>])</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">def</span> update_question(request, pk):</a>
<a class="sourceLine" id="cb7-3" title="3">    <span class="co">&quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">    Get the list of questions on our website</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">    &quot;&quot;&quot;</span></a>
<a class="sourceLine" id="cb7-6" title="6">    questions <span class="op">=</span> Question.objects.get(<span class="bu">id</span><span class="op">=</span>pk)</a>
<a class="sourceLine" id="cb7-7" title="7">    serializer <span class="op">=</span> QuestionSerializer(questions, data<span class="op">=</span>request.data, partial<span class="op">=</span><span class="va">True</span>)</a>
<a class="sourceLine" id="cb7-8" title="8">    <span class="cf">if</span> serializer.is_valid():</a>
<a class="sourceLine" id="cb7-9" title="9">        <span class="cf">return</span> Response(serializer.data)</a>
<a class="sourceLine" id="cb7-10" title="10">    <span class="cf">return</span> Response(status<span class="op">=</span><span class="dv">400</span>, data<span class="op">=</span>serializer.errors)</a></code></pre></div>
<p>and update the <code>polls/urls.py</code> file.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb8-1" title="1"><span class="im">from</span> django.urls <span class="im">import</span> path</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="im">from</span> . <span class="im">import</span> views</a>
<a class="sourceLine" id="cb8-3" title="3"></a>
<a class="sourceLine" id="cb8-4" title="4">urlpatterns <span class="op">=</span> [</a>
<a class="sourceLine" id="cb8-5" title="5">    ...</a>
<a class="sourceLine" id="cb8-6" title="6">    path(<span class="st">&#39;api/question/&lt;int:pk&gt;&#39;</span>, views.update_question, name<span class="op">=</span><span class="st">&#39;update_question&#39;</span>),</a>
<a class="sourceLine" id="cb8-7" title="7">]</a></code></pre></div>
<p>Run the project using <code>runserver</code> and go to this link <code>polls/api/question/1</code> and POST the following information below.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb9-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb9-2" title="2">    <span class="dt">&quot;question_text&quot;</span><span class="fu">:</span> <span class="st">&quot;Updated question text&quot;</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="fu">}</span></a></code></pre></div>
<p>After clicking the POST button you should see the updated value in the json structure above. The new value should also be reflected in the model admin page as well.</p>
<h4 id="other-cool-things-to-know">Other cool things to know</h4>
<ul>
<li>If your serializer is replicating a lot of information that’s also contained in the model being (de)serialized then you can use the <code>ModelSerializer</code> class to automatically generate the fields and produce a simple default implementations for the <code>create()</code> and <code>update()</code> methods</li>
<li>If you want to support alternative serialization and deserialization styles then you can inherit the <code>BaseSerializer</code> class and override these four functions depending on what functionality you want the serializer class to support:
<ul>
<li><code>.to_representation()</code> - Override this to support serialization, for read operations</li>
<li><code>.to_internal_value()</code> - Override this to support deserialization, for write operations</li>
<li><code>.create()</code> and <code>.update()</code> - Override either or both of these to support saving instances.</li>
</ul></li>
</ul>
<h4 id="more-information-about-drf">More information about DRF</h4>
<p>Her is the <a href="https://www.django-rest-framework.org/api-guide/serializers/">API Guide for Serializers</a></p>
<p>Here is the <a href="https://www.django-rest-framework.org/tutorial/1-serialization/">Tutorial guide</a></p>
<hr>
<h3>Optional/Outside of Lab</h3>
<p>It is in your best interest to Work through the rest of Django's First Steps Tutorials:</p>
<ul>
<li><a href="https://docs.djangoproject.com/en/3.1/intro/tutorial05/">Part 5: Testing</a></li>
<li><a href="https://docs.djangoproject.com/en/3.1/intro/tutorial06/">Part 6: Static Files</a></li>
<li><a href="https://docs.djangoproject.com/en/3.1/intro/tutorial07/">Part 7: Customizing the Admin Site</a></li>
</ul>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>